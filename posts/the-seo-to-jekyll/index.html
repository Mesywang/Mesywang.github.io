<!doctype html><html lang="en"> <!-- The Head © 2017-2019 Cotes Chung MIT License --><head><title>Jekyll 的 SEO 优化 | Cotes' Blog</title><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="favicon.ico" rel="apple-touch-icon"><link href="https://cdn.bootcss.com/twitter-bootstrap/4.0.0/css/bootstrap.min.css" rel="stylesheet"><link href="https://cdn.bootcss.com/font-awesome/5.1.0/css/all.css" rel="stylesheet"><link href="/assets/css/styles.css" rel="stylesheet"> <script src="https://cdn.bootcss.com/jquery/3.4.0/jquery.min.js"></script> <script src="https://cdn.bootcss.com/twitter-bootstrap/4.0.0/js/bootstrap.min.js" async></script> <script src="/assets/js/dist/commons.js" async></script> <!-- The GA snippet © 2017-2019 Cotes Chung MIT License --> <script> (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){ (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o), m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m) })(window,document,'script','/assets/lib/google-analytics/js/analytics.js','ga'); ga('create', 'UA-112933759-1', 'auto'); ga('send', 'pageview'); </script><link type="application/atom+xml" rel="alternate" href="/rss-feed.xml" /><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column"> <!-- The Side Bar © 2017-2019 Cotes Chung MIT License --><div id="nav-wrap"><div id="logo-wrap" class="d-flex justify-content-center"><div id="logo"> <a href="/" alt="site-logo"> <img src="https://cotes.gitee.io/blog-pics/avatar.jpg"></img> </a></div></div><div id="site-title" class="d-flex justify-content-center align-items-center"> <a href="/">Cotes' Blog</a></div><div id="site-slogan" class="font-italic">Blogging make more sense than playing video games.</div><ul class="nav flex-column"><li class="nav-item d-flex justify-content-center "> <a href="/" class="nav-link d-flex justify-content-center align-items-center w-100">HOME</a></li><li class="nav-item d-flex justify-content-center "> <a href="/tabs/categories/" class="nav-link d-flex justify-content-center align-items-center w-100">CATEGORIES</a></li><li class="nav-item d-flex justify-content-center "> <a href="/tabs/tags/" class="nav-link d-flex justify-content-center align-items-center w-100">TAGS</a></li><li class="nav-item d-flex justify-content-center "> <a href="/tabs/archives/" class="nav-link d-flex justify-content-center align-items-center w-100">ARCHIVES</a></li><li class="nav-item d-flex justify-content-center "> <a href="/tabs/about/" class="nav-link d-flex justify-content-center align-items-center w-100">ABOUT</a></li><span class="cursor"></span></ul></div><div class="contact d-flex justify-content-around mt-3"> <a href="https://github.com/cotes2020" target="_blank"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/cotes2020" target="_blank"> <i class="fab fa-twitter"></i> </a> <a href="mailto:cotes.chung@gmail.com" target="_blank"> <i class="fas fa-envelope"></i> </a> <a href="/rss-feed.xml" target="_blank"> <i class="fas fa-rss"></i> </a></div></div><div id="main-wrap"> <!-- The Top Bar © 2017-2019 Cotes Chung MIT License --><div id="topbar" class="bg-white row justify-content-center topbar-down"><div id="topbar-main" class="d-flex h-100 align-items-center justify-content-between col-12 col-md-12 col-lg-11 col-xl-11 pl-md-2 pr-md-2 pl-lg-2 pr-lg-2"> <span id="breadcrumb"> <span> <a href="/"> Posts </a> </span> <span>Jekyll 的 SEO 优化</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrap"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" placeholder="Search..."> </span> <a href="javascript:;">Cancel</a></div></div><div id="main"><div class="row justify-content-center bg-white"><div class="col-12 col-lg-11 col-xl-8"><div id="post-wrap" class="pl-sm-2 pr-sm-2 pl-xl-3"><div class="post"><h1 data-toc-skip>Jekyll 的 SEO 优化</h1><div class="post-meta text-muted d-flex flex-wrap"><div> 30 Oct 2018 on <a href='/categories/developer/'>Developer</a>, <a href='/categories/website/'>Website</a></div><div> <span id="pv" class="pageviews"><i class="fas fa-spinner fa-spin"></i></span> views</div><div> Updated 2 weeks ago</div></div><div class="post-content"><p>近来对博客主题、架构改进的热情明显高于写文章，略有本末倒置的意味。愧疚感驱使笔者写下最近为站点做的一些 SEO 优化：</p><ul><li>爬虫保护</li><li>目录访问保护</li><li>permalink</li></ul><h2 id="爬虫保护">爬虫保护</h2><p>万维网上的站点，都会被搜索引擎爬虫抓取内容，以之作为搜索结果列表。搜索引擎会依据站点根目录的<code class="highlighter-rouge">robots.txt</code>所定义的规则，去抓取当前站点的内容。</p><p>对于运行在 <strong>GitHub</strong> 或 <strong>Coding</strong> 的站点，默认会生成一个<code class="highlighter-rouge">robots.txt</code>，如本站该文件内容为：</p><div class="language-yml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">Sitemap</span><span class="pi">:</span> <span class="s">https://blog.cotes.in/sitemap.xml</span>
</code></pre></div></div><p>默认规则指向站点的 sitemap，为了告诉爬虫 bot 不去抓取某些图片、文件等静态资源，可以在<code class="highlighter-rouge">robots.txt</code>中新增自定义的指令。</p><p>首先在站点根目录新建文件<code class="highlighter-rouge">robots.txt</code>，接着添加爬虫指令：</p><p>指定 robots 范围，通配符<code class="highlighter-rouge">*</code>表示对所有robot适用：</p><div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>User-agent: *
</code></pre></div></div><p>指定禁止抓取的路径，请注意目录必须以<code class="highlighter-rouge">/</code>结尾：</p><div class="language-yml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">Disallow</span><span class="pi">:</span> <span class="s">/target_dir/</span>         <span class="c1"># 禁止目录</span>
<span class="na">Disallow</span><span class="pi">:</span> <span class="s">/targer_file.extend</span>  <span class="c1"># 禁止文件</span>
</code></pre></div></div><p>看了相关资料介绍，因为<code class="highlighter-rouge">robots.txt</code>文件是可以被直接访问的，所以在文件中直接列出具体目录，会暴露网站的目录结构，所以根据建议，在根目录建一个专门对 bots 隐藏的目录<code class="highlighter-rouge">/norobots/</code>，将所有需要隐藏的零碎文件、目录等挪到里面即可。</p><p>笔者的指令为：</p><div class="language-yml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">Disallow</span><span class="pi">:</span> <span class="s">/assets/</span>    <span class="c1"># /assets/ 是常规资源目录，不怕暴露路径</span>
<span class="na">Disallow</span><span class="pi">:</span> <span class="s">/norobots/</span>  <span class="c1"># 零碎敏感文件、目录等放置在此</span>
</code></pre></div></div><blockquote><p>注意：此时浏览器直接访问站点 $(HOST_DOMAIN)/norobots/还是可以看到文件列表的，达不到隐藏站点目录结构的目的，下文再作保护介绍。</p></blockquote><p>最后要增加对 sitemap 的指令:</p><div class="language-yml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">Sitemap</span><span class="pi">:</span> <span class="s">https://blog.cotes.in/sitemap.xml</span>
</code></pre></div></div><p>如果更换了域名，就要手动的更改<code class="highlighter-rouge">Sitemap</code>地址。此时可以使用 Jekyll 的全局配置变量取代硬编码：</p><p><code class="highlighter-rouge">robots.txt</code>文件顶部添加 Jekyll 的 Assets 声明(YAML)：</p><div class="language-yml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nn">---</span>
<span class="na">layout</span><span class="pi">:</span> <span class="no">null</span>
<span class="nn">---</span>
</code></pre></div></div><p>然后<code class="highlighter-rouge">Sitemap</code>指令修改为：</p><div class="language-yml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">Sitemap</span><span class="pi">:</span> <span class="pi">{{</span> <span class="nv">site.url</span> <span class="pi">}}</span><span class="s">/sitemap.xml</span>
</code></pre></div></div><p>这样域名就会随着<code class="highlighter-rouge">_config.yml</code>自动更改了。</p><p>完整的<code class="highlighter-rouge">robots.txt</code>内容如下：</p><div class="language-yml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nn">---</span>
<span class="na">layout</span><span class="pi">:</span> <span class="no">null</span>
<span class="na">permalink</span><span class="pi">:</span> <span class="s">robots.txt</span>
<span class="nn">---</span>

<span class="na">User-agent</span><span class="pi">:</span> <span class="err">*</span>

<span class="na">Disallow</span><span class="pi">:</span> <span class="s">/assts/</span>
<span class="na">Disallow</span><span class="pi">:</span> <span class="s">/norobots/</span>

<span class="na">Sitemap</span><span class="pi">:</span> <span class="pi">{{</span> <span class="nv">site.url</span> <span class="pi">}}</span><span class="s">/sitemap.xml</span>
</code></pre></div></div><h2 id="jekyll-目录保护">Jekyll 目录保护</h2><p>出于安全考虑，站点的某些目录结构，譬如上文提到的<code class="highlighter-rouge">/norobots/</code>，不希望被外部访问，所以需要使用重定向来保护目录。 部署在 <strong>GitHub</strong> 上的 Jekyll 站点，<strong>Apache Web Server</strong> 的<code class="highlighter-rouge">.htaccess</code>重定向规则会被无视（详见<a href="https://help.github.com/articles/redirects-on-github-pages/">官方介绍</a>)，所以可以使用 <strong>GitHub</strong> 推荐的Jekyll重定向插件<a href="https://github.com/jekyll/jekyll-redirect-from">jekyll-redirect-from</a>。</p><p><strong>GitHub Pages</strong> 默认支持该插件，在站点<code class="highlighter-rouge">_config.yml</code>中添加引用即可：</p><div class="language-yml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">plugins</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="s">jekyll-redirect-from</span>
</code></pre></div></div><p>如果在本地开发环境运行测试，可直通过 gem 命令在本地环境安装：</p><div class="language-terminal highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">$</span> gem <span class="nb">install </span>jekyll-redirect-from
</code></pre></div></div><p>然后在站点 404 页面的 YAML 头部添加跳转规则：</p><div class="language-yml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nn">---</span>
<span class="na">redirect_from</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="s">/norobots/</span>
<span class="nn">---</span>
</code></pre></div></div><p>具体的目录可以更具自己站点的实际情况定义，按照上述定义，访问<code class="highlighter-rouge">$(HOST)/norobots/</code>会直接返回 404 页面，从而保护了敏感目录。</p><h2 id="permalink-优化">Permalink 优化</h2><p>Permalink 是 'Permanent link' 的缩写，意为“永久链接”，即浏览器访问站点资源的完整路径地址。对于 SEO 而言，越短越精简的 permalink 越容易被发现及提高排名。Jekyll 理所当然的有对 permalink 提供模版支持。</p><p>如果 page 的<code class="highlighter-rouge">permalink</code>没有定义，则默认值为</p><div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>/:categories/:year/:month/:day/:title:output_ext
</code></pre></div></div><blockquote><p>详细的<code class="highlighter-rouge">permalink</code>可选值请参考<a href="https://jekyllrb.com/docs/permalinks/">Jekyll 的 Permalink 介绍</a>。</p></blockquote><p>如本文，默认 permalink 是:<code class="highlighter-rouge">https://blog.cotes.in/developer/2018/10/30/the-seo-to-jekyll.html</code>，很长的一串，对吧。SEO 建议 permalink长度不超过 90 个字符，目录层次不超过 3 层，所以为了精简 permalink，计划去掉<code class="highlighter-rouge">categories</code>, <code class="highlighter-rouge">year</code>, <code class="highlighter-rouge">month</code>, <code class="highlighter-rouge">day</code>, <code class="highlighter-rouge">output_ext</code>。</p><p>为了全局生效，在站点根目录<code class="highlighter-rouge">_config.yml</code>文件添加对<code class="highlighter-rouge">permalink</code>的赋值：</p><div class="language-yml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">permalink</span><span class="pi">:</span> <span class="s">/:title/</span>
</code></pre></div></div><p>上述变量表示：文件站内链接格式为<code class="highlighter-rouge">/{{ page.title }}/</code>，隐藏了静态文件的后缀，如<code class="highlighter-rouge">.html</code>。 在末尾加<code class="highlighter-rouge">/</code>是为了区分带扩展名的访问：若 permalink 定义为<code class="highlighter-rouge">/:title</code>，访问<code class="highlighter-rouge">/:title:output_ext</code>是被允许的。 精简后，本文链接地址为：<code class="highlighter-rouge">https://blog.cotes.in/the-seo-to-jekyll/</code>，有效提高了 SEO 表现。</p><blockquote><p>过程中曾担心只剩标题会不会引起文件名重叠，后来细想一下，post的标题都是短句，机率很小，万一真有重名，可以末端添加数字区分。</p></blockquote><p>值得一提的是，博客内部原有的带<code class="highlighter-rouge">.html</code>后缀的跳转Url也要相应修改，需要付出一定的时间去细心校验。</p><h2 id="结语">结语</h2><p>本文只是对建站动态的阶段性小结，SEO 的玩法远不止这些，有兴趣可以自行查找更多资料。</p><h2 id="参考链接">参考链接</h2><ul><li><p><a href="https://moz.com/learn/seo/robotstxt">SEO Learning Center: Robots.txt</a></p></li><li><p><a href="https://jekyllrb.com/docs/permalinks/">Jekyll Docs: Permalinks</a></p></li></ul></div><div class="post-tail text-muted"><div class="mb-2"> <a href="/tags/seo/" class="post-tag no-text-decoration" >SEO</a>&ensp; <a href="/tags/robots/" class="post-tag no-text-decoration" >robots</a>&ensp; <a href="/tags/jekyll/" class="post-tag no-text-decoration" >Jekyll</a></div></div></div><div class="post-pager d-flex justify-content-between"> <a href="/posts/the-nomadic-tactics-of-aoe/" class="btn btn-outline-primary"> <i class="fas fa-angle-left mr-2"></i>OLDER POSTS </a> <a href="/posts/integrate-travis-ci-in-jekyll/" class="btn btn-outline-primary"> NEWER POSTS<i class="fas fa-angle-right ml-2"></i> </a></div><!-- The Disqus snippet. © 2017-2019 Cotes Chung MIT License --><div id="disqus_thread" class="pt-2 pb-4"><p class="font-italic text-muted small">Comments powered by <a href="https://disqus.com/">Disqus</a>.</p></div><script> /** * RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS. * LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables*/ var disqus_config = function() { this.page.url = 'https://blog.cotes.info/posts/the-seo-to-jekyll/'; this.page.identifier = '/posts/the-seo-to-jekyll/'; }; (function() { var isBlocked = true; var d = document, s = d.createElement('script'); s.src = 'https://cotess-blog.disqus.com/embed.js'; s.setAttribute('data-timestamp', +new Date()); s.onload = function() { isBlocked = false; }; (d.head || d.body).appendChild(s); setTimeout(function() { console.log("Disqus loading is blocked."); }, 3000); })(); </script> </script> <noscript> Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a> </noscript></div></div><div id="post-panel" class="col-xl-3 pl-2"> <!-- The Pannel on right side (Desktop views) © 2017-2019 Cotes Chung MIT License --><div class="panel-group"><div id="panel-update" class="post mb-4""><h3 data-toc-skip> Recent Update</h3><ul class="post-content pl-0 mt-2 pb-1"><li><a href="/posts/split-posts-n-metadata-of-blog/ ">博客架构分拆</a></li><li><a href="/posts/integrate-travis-ci-in-jekyll/ ">Jekyll 集成 Travis CI</a></li><li><a href="/posts/shortcut-on-macos/ ">macOS 环境快捷键</a></li><li><a href="/posts/use-gnu-utilities-in-mac/ ">Mac 中使用 GNU 命令</a></li><li><a href="/posts/replace-cn-mirror-for-homebrew/ ">Homebrew 替换国内源</a></li></ul></div><div id="panel-tags"><h3 data-toc-skip> Trending Tags</h3><div class="d-flex flex-wrap mt-2 pb-1 pr-3"><div> <a class="post-tag" href="/tags/jekyll/">Jekyll</a> <a class="post-tag" href="/tags/macos/">macOS</a> <a class="post-tag" href="/tags/nginx/">Nginx</a> <a class="post-tag" href="/tags/travis/">Travis</a> <a class="post-tag" href="/tags/story/">Story</a> <a class="post-tag" href="/tags/shadowsocks/">Shadowsocks</a> <a class="post-tag" href="/tags/mobi/">MOBI</a> <a class="post-tag" href="/tags/kc2/">KC2</a> <a class="post-tag" href="/tags/homebrew/">Homebrew</a> <a class="post-tag" href="/tags/github/">GitHub</a></div></div></div></div><div id="toc-wrap" class="topbar-down pr-4"><h3 data-toc-skip class="pl-3 pt-2"> Contents</h3><nav id="toc" data-toggle="toc"></nav></div></div><link rel="stylesheet" href="/assets/lib/bootstrap-toc-1.0.1/bootstrap-toc.min.css"> <script src="/assets/lib/bootstrap-toc-1.0.1/bootstrap-toc.min.js" async></script> <script src="/assets/js/dist/countUp.min.js" async></script> <script src="/assets/js/dist/pageviews.min.js" async></script></div><!-- The Footer © 2017-2019 Cotes Chung MIT License --><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="copyright"><p class="mb-0"> <span>© 2017-2019</span> <span class="copyright-owner">Cotes Chung</span>. <br>Powered by <a href="https://jekyllrb.com" target="_blank">Jekyll</a>, hosted on <a href="https://pages.github.com/" target="_blank">GitHub Pages</a>.</p></div><div class="license"><p class="mb-0"> Posts on this site are licensed under the <a href="http://creativecommons.org/licenses/by-nc/4.0/">Creative Commons Attribution 4.0 International (CC BY 4.0) License</a>.</p></div></div></footer></div><!-- The Search results © 2017-2019 Cotes Chung MIT License --><div id="search-result-wrap"><div class="row justify-content-center bg-white"><div class="col-12 col-md-12 col-lg-11 col-xl-9 pl-xl-5 pr-xl-5 pb-5 mt-3 mb-3"><h2 class="mt-3 pt-3 ml-3 ml-md-5 ml-lg-0" data-toc-skip>Search Results</h2><div class="post-content ml-1 ml-md-5 ml-lg-0"><ul id="search-results" ></ul></div></div></div></div></div><div id="mask"></div><!-- The Search © 2017-2019 Cotes Chung MIT License --> <script src="/assets/lib/simple-jekyll-search/search-script.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/search.json' }) </script> <a id="back-to-top" href="#" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a>
