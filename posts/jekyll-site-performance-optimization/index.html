<!doctype html><html lang="en"> <!-- The Head © 2017-2019 Cotes Chung MIT License --><head><title>Jekyll 网站性能优化 | Cotes' Blog</title><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="favicon.ico" rel="apple-touch-icon"><link href="https://cdn.bootcss.com/twitter-bootstrap/4.0.0/css/bootstrap.min.css" rel="stylesheet"><link href="https://cdn.bootcss.com/font-awesome/5.1.0/css/all.css" rel="stylesheet"><link href="/assets/css/styles.css" rel="stylesheet"> <script src="https://cdn.bootcss.com/jquery/3.4.0/jquery.min.js"></script> <script src="https://cdn.bootcss.com/twitter-bootstrap/4.0.0/js/bootstrap.min.js" async></script> <script src="/assets/js/dist/commons.js" async></script> <!-- The GA snippet © 2017-2019 Cotes Chung MIT License --> <script> (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){ (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o), m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m) })(window,document,'script','/assets/lib/google-analytics/js/analytics.js','ga'); ga('create', 'UA-112933759-1', 'auto'); ga('send', 'pageview'); </script><link type="application/atom+xml" rel="alternate" href="/rss-feed.xml" /><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column"> <!-- The Side Bar © 2017-2019 Cotes Chung MIT License --><div id="nav-wrap"><div id="logo-wrap" class="d-flex justify-content-center"><div id="logo"> <a href="/" alt="site-logo"> <img src="https://cotes.gitee.io/blog-pics/avatar.jpg"></img> </a></div></div><div id="site-title" class="d-flex justify-content-center align-items-center"> <a href="/">Cotes' Blog</a></div><div id="site-slogan" class="font-italic">Blogging make more sense than playing video games.</div><ul class="nav flex-column"><li class="nav-item d-flex justify-content-center "> <a href="/" class="nav-link d-flex justify-content-center align-items-center w-100">HOME</a></li><li class="nav-item d-flex justify-content-center "> <a href="/tabs/categories/" class="nav-link d-flex justify-content-center align-items-center w-100">CATEGORIES</a></li><li class="nav-item d-flex justify-content-center "> <a href="/tabs/tags/" class="nav-link d-flex justify-content-center align-items-center w-100">TAGS</a></li><li class="nav-item d-flex justify-content-center "> <a href="/tabs/archives/" class="nav-link d-flex justify-content-center align-items-center w-100">ARCHIVES</a></li><li class="nav-item d-flex justify-content-center "> <a href="/tabs/about/" class="nav-link d-flex justify-content-center align-items-center w-100">ABOUT</a></li><span class="cursor"></span></ul></div><div class="contact d-flex justify-content-around mt-3"> <a href="https://github.com/cotes2020" target="_blank"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/cotes2020" target="_blank"> <i class="fab fa-twitter"></i> </a> <a href="mailto:cotes.chung@gmail.com" target="_blank"> <i class="fas fa-envelope"></i> </a> <a href="/rss-feed.xml" target="_blank"> <i class="fas fa-rss"></i> </a></div></div><div id="main-wrap"> <!-- The Top Bar © 2017-2019 Cotes Chung MIT License --><div id="topbar" class="bg-white row justify-content-center topbar-down"><div id="topbar-main" class="d-flex h-100 align-items-center justify-content-between col-12 col-md-12 col-lg-11 col-xl-11 pl-md-2 pr-md-2 pl-lg-2 pr-lg-2"> <span id="breadcrumb"> <span> <a href="/"> Posts </a> </span> <span>Jekyll 网站性能优化</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrap"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" placeholder="Search..."> </span> <a href="javascript:;">Cancel</a></div></div><div id="main"><div class="row justify-content-center bg-white"><div class="col-12 col-lg-11 col-xl-8"><div id="post-wrap" class="pl-sm-2 pr-sm-2 pl-xl-3"><div class="post"><h1 data-toc-skip>Jekyll 网站性能优化</h1><div class="post-meta text-muted d-flex flex-wrap"><div> 19 Aug 2018 on <a href='/categories/developer/'>Developer</a>, <a href='/categories/website/'>Website</a></div><div> <span id="pv" class="pageviews"><i class="fas fa-spinner fa-spin"></i></span> views</div><div> Updated 1 week ago</div></div><div class="post-content"><p>近来，突然觉博客项目的 CSS 内容越来越多，多次在 HTML 与 CSS 之间增减内容，就会增加残留无效 CSS 内容的概率。经过查找资料，发现 Chrome 的 DevTools 自带的<code class="highlighter-rouge">Coverage</code>功能可以很好的解决这个问题。好奇心驱使下，自然想着寻找更多玩法，能不能借助 DevTools 提高网站性能呢？答案是肯定的。<code class="highlighter-rouge">Lighthouse</code>是 Chrome 的性能审查扩展程序，位置在 DevTools 的<code class="highlighter-rouge">Audits</code>选项栏。根据自动化审查结果，可以知道网站性能短板所在，再由报告提供的建议去优化缺陷。</p><h2 id="lighthouse-审查">Lighthouse 审查</h2><p><img src="https://cotes.gitee.io/blog-pics/1808190/0.png" alt="devtool-audits" /> <code class="highlighter-rouge">Audits</code>有五项审查内容，分别是<code class="highlighter-rouge">Performance</code>, <code class="highlighter-rouge">Progressive Web App</code>, <code class="highlighter-rouge">Best parctices</code>, <code class="highlighter-rouge">Accessibility</code>, <code class="highlighter-rouge">SEO</code>等，可以根据自己的需要选择。本文针对其中的<code class="highlighter-rouge">Performance</code>(性能)。Chrome 打开目标网页，启动<code class="highlighter-rouge">Audits</code>，十几秒内即可完成审查。 网站的性能优化大概有以下几个方向：</p><ul><li>JS 异步加载</li><li>按业务分拆 JS/CSS 的调用</li><li>HTML 消除内嵌样式</li><li>压缩 JS，CSS，HTML</li></ul><p>下面将逐项叙述每个优化过程细节。</p><h2 id="js-异步加载">JS 异步加载</h2><p>当浏览器扫描项目时，<a href="https://developers.google.com/web/fundamentals/performance/critical-rendering-path/adding-interactivity-with-javascript">JS 代码便会阻止构建 DOM</a>。对页面样式展示非必要的 JS 代码，可以使用异步调用，在<code class="highlighter-rouge">&lt;script&gt;</code>内部添加<code class="highlighter-rouge">async</code>标记。例如：</p><div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;script </span><span class="na">src=</span><span class="s">"/assets/js/common.js"</span> <span class="na">async</span><span class="nt">&gt;&lt;/script&gt;</span>
</code></pre></div></div><h2 id="分场景调用-jscss">分场景调用 JS/CSS</h2><p>在 Jekyll 中，<code class="highlighter-rouge">{% include %}</code>的应用可以增加代码的简洁性，也可能造成页面的 JS/CSS 冗余。一般 Jekyll 项目的习惯是，项目所有的 JS/CSS 都在<code class="highlighter-rouge">_includes/head.html</code>中引入，然后通过<code class="highlighter-rouge">{% include head.html %}</code>导入每个下层layout。很多时候，部分 JS/CSS 并不是每个页面都必须的。</p><p>例如，本站的<code class="highlighter-rouge">post</code>布局需要<code class="highlighter-rouge">bootstrap-toc.js</code>，此外的<code class="highlighter-rouge">page</code>布局，<code class="highlighter-rouge">home</code>布局都不需要 toc 相关的 JS/CSS。 这时应该把<code class="highlighter-rouge">bootstrap-toc</code>相关的 JS/CSS 单独放置到<code class="highlighter-rouge">post</code>布局上引用，从而增加了其他布局的加载及渲染速度。</p><h2 id="html-去除内嵌样式">HTML 去除内嵌样式</h2><p>HTML 元素内部的<code class="highlighter-rouge">style</code>会降低渲染效率，如：</p><div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;span</span> <span class="na">style=</span><span class="s">"background: #fff; color: gray;"</span><span class="nt">&gt;</span>Some codes<span class="nt">&lt;/span&gt;</span>
</code></pre></div></div><p>应定义一个class去替代：</p><div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;style&gt;</span>
<span class="o">.</span> <span class="nt">mystyle</span> <span class="p">{</span> <span class="nl">background</span><span class="p">:</span> <span class="m">#fff</span><span class="p">;</span> <span class="nl">color</span><span class="p">:</span> <span class="no">gray</span><span class="p">;</span> <span class="p">}</span>
<span class="nt">&lt;/style&gt;</span>

<span class="nt">&lt;span</span> <span class="na">class=</span><span class="s">"mystyle"</span><span class="nt">&gt;</span>Some codes<span class="nt">&lt;/span&gt;</span>
</code></pre></div></div><h2 id="css-压缩">CSS 压缩</h2><p>使用 Jekyll 提供的 sass pipeline 压缩，每次编译的时候会自动压缩引入的 scss 文件，十分便捷。使用方法是，在项目<code class="highlighter-rouge">_config.yml</code>文件添加 sass 配置：</p><div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">sass</span><span class="pi">:</span>
  <span class="na">sass_dir</span><span class="pi">:</span> <span class="s">/assets/css</span> <span class="c1"># Override jekyll default path '/_sass'</span>
  <span class="na">style</span><span class="pi">:</span>  <span class="s">compressed</span>
</code></pre></div></div><p>其中<code class="highlighter-rouge">sass_dir</code>为项目 CSS 目录。</p><p>将自己编写的 CSS 3 文件后缀修改为<code class="highlighter-rouge">.scss</code>，在 CSS 文件目录<code class="highlighter-rouge">/assets/css</code>下新建一个文件，命名为<code class="highlighter-rouge">styles.scss</code>，添加导入所需的 scss。例如，导入<code class="highlighter-rouge">styles.scss</code>同目录下的<code class="highlighter-rouge">main.scss</code>、<code class="highlighter-rouge">syntax.scss</code>两个文件，则<code class="highlighter-rouge">styles.scss</code>添加内容：</p><div class="language-scss highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">---</span>
<span class="nt">---</span>

<span class="o">@</span><span class="nt">import</span> <span class="s2">"main"</span><span class="p">;</span>
<span class="k">@import</span> <span class="s2">"syntax"</span><span class="p">;</span>
</code></pre></div></div><p>项目<code class="highlighter-rouge">&lt;head&gt;</code>引用作相应修改，去掉原先对每个独立 CSS 文件的<code class="highlighter-rouge">&lt;link rel="stylesheet"&gt;</code>引用，改为对<code class="highlighter-rouge">styles.css</code>的引用:</p><div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;link</span> <span class="na">rel=</span><span class="s">"stylesheet"</span> <span class="na">href=</span><span class="s">"/assets/css/styles.css"</span><span class="nt">&gt;</span>
</code></pre></div></div><blockquote><p>引用文件后缀使用了<code class="highlighter-rouge">.css</code>，这是因为<code class="highlighter-rouge">.scss</code>编译后后缀会被自动改为<code class="highlighter-rouge">.css</code>。</p></blockquote><h2 id="js-压缩优化">JS 压缩优化</h2><p>项目中自己编写的 JS 以及第三方的 JS 文件(未压缩)，可使用 <a href="http://yui.github.io/yuicompressor/">YUI Compressor</a> 压缩，压缩结果命名可以在<code class="highlighter-rouge">.js</code>后缀前添加<code class="highlighter-rouge">min</code>标识。如原文件<code class="highlighter-rouge">tools.js</code>压缩后命名为<code class="highlighter-rouge">tools.min.js</code>。</p><div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>java <span class="nt">-jar</span> yuicompressor.jar tools.js <span class="nt">-o</span> tools.min.js
</code></pre></div></div><p>接着使用Jekyll的Assest特征合并引用所需的 JS，在 JS 目录下新建文件<code class="highlighter-rouge">common.js</code>，使用<code class="highlighter-rouge">{% include %}</code>引入其他 JS，如本站内容为：</p><div class="language-liquid highlighter-rouge"><div class="highlight"><pre class="highlight"><code>---
---

<span class="p">{%</span><span class="w"> </span><span class="nt">include</span><span class="nv">_relative</span><span class="w"> </span><span class="nv">dist</span>/<span class="nv">back</span>-<span class="nv">to</span>-<span class="nv">top</span><span class="p">.</span><span class="nv">min</span><span class="p">.</span><span class="nv">js</span><span class="w"> </span><span class="p">%}</span>
<span class="p">{%</span><span class="w"> </span><span class="nt">include</span><span class="nv">_relative</span><span class="w"> </span><span class="nv">dist</span>/<span class="nv">category</span>-<span class="nv">collapse</span><span class="p">.</span><span class="nv">min</span><span class="p">.</span><span class="nv">js</span><span class="w"> </span><span class="p">%}</span>
<span class="p">{%</span><span class="w"> </span><span class="nt">include</span><span class="nv">_relative</span><span class="w"> </span><span class="nv">dist</span>/<span class="nv">search</span>-<span class="nv">display</span><span class="p">.</span><span class="nv">min</span><span class="p">.</span><span class="nv">js</span><span class="w"> </span><span class="p">%}</span>
<span class="p">{%</span><span class="w"> </span><span class="nt">include</span><span class="nv">_relative</span><span class="w"> </span><span class="nv">dist</span>/<span class="nv">sidebar</span>-<span class="nv">toggle</span><span class="p">.</span><span class="nv">min</span><span class="p">.</span><span class="nv">js</span><span class="w"> </span><span class="p">%}</span>
</code></pre></div></div><p>项目HTML的<code class="highlighter-rouge">head</code>中使用合并文件替代分开的几个文件引用：</p><div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;script </span><span class="na">src=</span><span class="s">"/assets/js/common.js"</span> <span class="na">async</span><span class="nt">&gt;&lt;/script&gt;</span>
</code></pre></div></div><h2 id="html-压缩">HTML 压缩</h2><p>对于 Jekyll，有一个 Liquid 实现的开源方案提供解决：<a href="https://github.com/penibelst/jekyll-compress-html">Jekyll-Compress-Html</a>。</p><p>安装很简单，首先到 <a href="https://github.com/penibelst/jekyll-compress-html/releases">Release</a> 下载最新版的<code class="highlighter-rouge">compress.html</code>，拷贝到项目的<code class="highlighter-rouge">_layouts</code>目录下。然后修改最顶级的默认样式 <code class="highlighter-rouge">_layouts/default.html</code>，在它的头部添加 Yaml:</p><div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nn">---</span>
<span class="na">layout</span><span class="pi">:</span> <span class="s">compress</span>
<span class="nn">---</span>
</code></pre></div></div><p>然后，在<code class="highlighter-rouge">_config.yml</code>添加配置：</p><div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">compress_html</span><span class="pi">:</span>
  <span class="na">clippings</span><span class="pi">:</span> <span class="s">all</span>
  <span class="na">comments</span><span class="pi">:</span> <span class="pi">[</span><span class="s2">"</span><span class="s">&lt;!--</span><span class="nv"> </span><span class="s">"</span><span class="pi">,</span> <span class="s2">"</span><span class="nv"> </span><span class="s">--&gt;"</span><span class="pi">]</span>
  <span class="na">endings</span><span class="pi">:</span> <span class="pi">[</span><span class="nv">html</span><span class="pi">,</span> <span class="nv">head</span><span class="pi">,</span> <span class="nv">body</span><span class="pi">,</span> <span class="nv">li</span><span class="pi">,</span> <span class="nv">dt</span><span class="pi">,</span> <span class="nv">dd</span><span class="pi">,</span> <span class="nv">rt</span><span class="pi">,</span> <span class="nv">rp</span><span class="pi">,</span> <span class="nv">optgroup</span><span class="pi">,</span> <span class="nv">option</span><span class="pi">,</span> <span class="nv">colgroup</span><span class="pi">,</span> <span class="nv">caption</span><span class="pi">,</span> <span class="nv">thead</span><span class="pi">,</span> <span class="nv">tbody</span><span class="pi">,</span> <span class="nv">tfoot</span><span class="pi">,</span> <span class="nv">tr</span><span class="pi">,</span> <span class="nv">td</span><span class="pi">,</span> <span class="nv">th</span><span class="pi">]</span>
  <span class="na">profile</span><span class="pi">:</span> <span class="no">false</span>
  <span class="na">blanklines</span><span class="pi">:</span> <span class="no">false</span>
  <span class="na">ignore</span><span class="pi">:</span>
    <span class="na">envs</span><span class="pi">:</span> <span class="pi">[]</span>
</code></pre></div></div><p>具体每个参数的含义可以参考项目README介绍，经过几步即完成了插件的安装。该注意的是，如果post使用了 Jekyll 的<code class="highlighter-rouge">linenos</code>，则需要额外解决<a href="https://github.com/penibelst/jekyll-compress-html/issues/71">内嵌<code class="highlighter-rouge">&lt;pre&gt;</code>压缩错乱的 BUG</a>。</p><p>具体表现为, 原始状态使用<code class="highlighter-rouge">{% highlight LANGUAGE linenos %}</code>时，生成的代码格式为：</p><div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;figure</span> <span class="na">class=</span><span class="s">"highlight"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;pre&gt;</span>
    <span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"..."</span> <span class="na">data-lang=</span><span class="s">"..."</span><span class="nt">&gt;</span>
    Code snippet
    <span class="nt">&lt;/code&gt;</span>
  <span class="nt">&lt;/pre&gt;</span>
<span class="nt">&lt;/figure&gt;</span>
</code></pre></div></div><p>当压缩HTML时，会把最外层的<code class="highlighter-rouge">&lt;pre&gt;</code>及<code class="highlighter-rouge">&lt;/pre&gt;</code>删除，但是不完整，残留<code class="highlighter-rouge">/&gt;</code>：</p><div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;figure</span> <span class="na">class=</span><span class="s">"highlight"</span><span class="nt">&gt;</span>
  /&gt;
    <span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"..."</span> <span class="na">data-lang=</span><span class="s">"..."</span><span class="nt">&gt;</span>
    Code snippet
    <span class="nt">&lt;/code&gt;</span>
<span class="nt">&lt;/figure&gt;</span>
</code></pre></div></div><p>虽然这会造成样式大错乱，但是项目维护者不打算修改这个bug，认为这样会增加扫描层数，大大增加项目 build 的时间。上述 issues-71 中，已经有用户提供了解决方法： 在<code class="highlighter-rouge">_includes/</code>中新建文件<code class="highlighter-rouge">fixlinenos.html</code>，添加内容：</p><div class="language-liquid highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{%</span><span class="w"> </span><span class="kr">if</span><span class="w"> </span><span class="nv">_code</span><span class="w"> </span><span class="ow">contains</span><span class="w"> </span><span class="s1">'&lt;pre class="lineno"&gt;'</span><span class="w"> </span><span class="p">%}</span>
  <span class="p">{%</span><span class="w"> </span><span class="nt">assign</span><span class="w"> </span><span class="nv">_code</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">_code</span><span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="nf">replace</span><span class="p">:</span><span class="w"> </span><span class="s2">"&lt;pre&gt;&lt;code"</span><span class="p">,</span><span class="w"> </span><span class="s2">"&lt;code"</span><span class="w"> </span><span class="p">%}</span>
  <span class="p">{%</span><span class="w"> </span><span class="nt">assign</span><span class="w"> </span><span class="nv">_code</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">_code</span><span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="nf">replace</span><span class="p">:</span><span class="w"> </span><span class="s2">"&lt;/code&gt;&lt;/pre&gt;"</span><span class="p">,</span><span class="w"> </span><span class="s2">"&lt;/code&gt;"</span><span class="w"> </span><span class="p">%}</span>
<span class="p">{%</span><span class="w"> </span><span class="kr">endif</span><span class="w"> </span><span class="p">%}</span>
</code></pre></div></div><p>在每篇 post 源码中，调用<code class="highlighter-rouge">{% highlight LANGUAGE linenos %}</code>的地方作出修改。</p><p>原始代码：</p><div class="language-liquid highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{%</span><span class="w"> </span><span class="nt">highlight</span><span class="w"> </span>AnyLanguage<span class="w"> </span>linenos<span class="w"> </span><span class="p">%}</span>
  Some code
<span class="p">{%</span><span class="w"> </span><span class="nt">endhighlight</span><span class="w"> </span><span class="p">%}</span>
</code></pre></div></div><p>应修改为：</p><div class="language-liquid highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{%</span><span class="w"> </span><span class="nt">capture</span><span class="w"> </span><span class="na">_code</span><span class="w"> </span><span class="p">%}</span>
<span class="p">{%</span><span class="w"> </span><span class="nt">highlight</span><span class="w"> </span>AnyLanguage<span class="w"> </span>linenos<span class="w"> </span><span class="p">%}</span>
  Some code
<span class="p">{%</span><span class="w"> </span><span class="nt">endhighlight</span><span class="w"> </span><span class="p">%}</span>
<span class="p">{%</span><span class="w"> </span><span class="nt">endcapture</span><span class="w"> </span><span class="p">%}{%</span><span class="w"> </span><span class="nt">include</span><span class="w"> </span><span class="na">fixlinenos</span><span class="p">.</span><span class="na">html</span><span class="w"> </span><span class="p">%}{{</span><span class="w"> </span><span class="nv">_code</span><span class="w"> </span><span class="p">}}</span>
</code></pre></div></div><p>这样压缩就不会出现问题了，可是要注意的是，<code class="highlighter-rouge">&lt;pre&gt;</code>被<code class="highlighter-rouge">fixlinenos.html</code>清除后，代码段的<code class="highlighter-rouge">overflow: auto</code>也会消失，需要为<code class="highlighter-rouge">figure.highlight</code>添加样式<code class="highlighter-rouge">overflow: auto</code>对超出父容器宽度的代码作水平滑动。</p><h2 id="json-压缩">JSON 压缩</h2><p>这个是个意外发现，和上一步 <a href="#html-压缩">HTML 压缩</a> 一样，文件头部加YAML声明调用压缩的<code class="highlighter-rouge">layout</code>即可：</p><div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nn">---</span>
<span class="na">layout</span><span class="pi">:</span> <span class="s">compress</span>
<span class="nn">---</span>
</code></pre></div></div><h2 id="服务器-gzip-压缩">服务器 GZIP 压缩</h2><p>传输过程可以开启 Web 服务器的GZIP选项，如果博客是部署在 GitHub Pages 或 Coding Pages ，则默认开启了 GZIP 压缩传输。若是自己个人部署的 Web 服务器，如 Nginx，Apache 等，则需要跟进此点优化。</p><h2 id="结语">结语</h2><p>上述只是针对本站的优化，并没有覆盖常规网站的所有优化点，更加全面细致的性能建议，可参考 <a href="https://developers.google.com/web/fundamentals/performance/why-performance-matters/">Google 开发者文档</a>。</p></div><div class="post-tail text-muted"><div class="mb-2"> <a href="/tags/jekyll/" class="post-tag no-text-decoration" >Jekyll</a>&ensp; <a href="/tags/css/" class="post-tag no-text-decoration" >CSS</a>&ensp; <a href="/tags/js/" class="post-tag no-text-decoration" >JS</a>&ensp; <a href="/tags/html/" class="post-tag no-text-decoration" >HTML</a></div></div></div><div class="post-pager d-flex justify-content-between"> <a href="/posts/speed-up-shadowsocks-by-kcptunp/" class="btn btn-outline-primary"> <i class="fas fa-angle-left mr-2"></i>OLDER POSTS </a> <a href="/posts/fetch-pageviews-from-google-analytics/" class="btn btn-outline-primary"> NEWER POSTS<i class="fas fa-angle-right ml-2"></i> </a></div><!-- The Disqus snippet. © 2017-2019 Cotes Chung MIT License --><div id="disqus_thread" class="pt-2 pb-4"><p class="font-italic text-muted small">Comments powered by <a href="https://disqus.com/">Disqus</a>.</p></div><script> /** * RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS. * LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables*/ var disqus_config = function() { this.page.url = 'https://blog.cotes.info/posts/jekyll-site-performance-optimization/'; this.page.identifier = '/posts/jekyll-site-performance-optimization/'; }; (function() { var isBlocked = true; var d = document, s = d.createElement('script'); s.src = 'https://cotess-blog.disqus.com/embed.js'; s.setAttribute('data-timestamp', +new Date()); s.onload = function() { isBlocked = false; }; (d.head || d.body).appendChild(s); setTimeout(function() { console.log("Disqus loading is blocked."); }, 3000); })(); </script> </script> <noscript> Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a> </noscript></div></div><div id="post-panel" class="col-xl-3 pl-2"> <!-- The Pannel on right side (Desktop views) © 2017-2019 Cotes Chung MIT License --><div class="panel-group"><div id="panel-update" class="post mb-4""><h3 data-toc-skip> Recent Update</h3><ul class="post-content pl-0 mt-2 pb-1"><li><a href="/posts/split-posts-n-metadata-of-blog/ ">博客架构分拆</a></li><li><a href="/posts/integrate-travis-ci-in-jekyll/ ">Jekyll 集成 Travis CI</a></li><li><a href="/posts/shortcut-on-macos/ ">macOS 环境快捷键</a></li><li><a href="/posts/use-gnu-utilities-in-mac/ ">Mac 中使用 GNU 命令</a></li><li><a href="/posts/replace-cn-mirror-for-homebrew/ ">Homebrew 替换国内源</a></li></ul></div><div id="panel-tags"><h3 data-toc-skip> Trending Tags</h3><div class="d-flex flex-wrap mt-2 pb-1 pr-3"><div> <a class="post-tag" href="/tags/jekyll/">Jekyll</a> <a class="post-tag" href="/tags/macos/">macOS</a> <a class="post-tag" href="/tags/nginx/">Nginx</a> <a class="post-tag" href="/tags/travis/">Travis</a> <a class="post-tag" href="/tags/story/">Story</a> <a class="post-tag" href="/tags/shadowsocks/">Shadowsocks</a> <a class="post-tag" href="/tags/mobi/">MOBI</a> <a class="post-tag" href="/tags/kc2/">KC2</a> <a class="post-tag" href="/tags/homebrew/">Homebrew</a> <a class="post-tag" href="/tags/github/">GitHub</a></div></div></div></div><div id="toc-wrap" class="topbar-down pr-4"><h3 data-toc-skip class="pl-3 pt-2"> Contents</h3><nav id="toc" data-toggle="toc"></nav></div></div><link rel="stylesheet" href="/assets/lib/bootstrap-toc-1.0.1/bootstrap-toc.min.css"> <script src="/assets/lib/bootstrap-toc-1.0.1/bootstrap-toc.min.js" async></script> <script src="/assets/js/dist/countUp.min.js" async></script> <script src="/assets/js/dist/pageviews.min.js" async></script></div><!-- The Footer © 2017-2019 Cotes Chung MIT License --><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="copyright"><p class="mb-0"> <span>© 2017-2019</span> <span class="copyright-owner">Cotes Chung</span>. <br>Powered by <a href="https://jekyllrb.com" target="_blank">Jekyll</a>, hosted on <a href="https://pages.github.com/" target="_blank">GitHub Pages</a>.</p></div><div class="license"><p class="mb-0"> Posts on this site are licensed under the <a href="http://creativecommons.org/licenses/by-nc/4.0/">Creative Commons Attribution 4.0 International (CC BY 4.0) License</a>.</p></div></div></footer></div><!-- The Search results © 2017-2019 Cotes Chung MIT License --><div id="search-result-wrap"><div class="row justify-content-center bg-white"><div class="col-12 col-md-12 col-lg-11 col-xl-9 pl-xl-5 pr-xl-5 pb-5 mt-3 mb-3"><h2 class="mt-3 pt-3 ml-3 ml-md-5 ml-lg-0" data-toc-skip>Search Results</h2><div class="post-content ml-1 ml-md-5 ml-lg-0"><ul id="search-results" ></ul></div></div></div></div></div><div id="mask"></div><!-- The Search © 2017-2019 Cotes Chung MIT License --> <script src="/assets/lib/simple-jekyll-search/search-script.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/search.json' }) </script> <a id="back-to-top" href="#" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a>
